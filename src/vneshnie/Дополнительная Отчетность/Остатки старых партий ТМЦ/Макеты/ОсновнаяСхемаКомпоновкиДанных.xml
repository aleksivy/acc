<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Счет</dataPath>
				<field>Счет</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СчетКт</dataPath>
				<field>СчетКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СчетДт</dataPath>
				<field>СчетДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто1</dataPath>
				<field>Субконто1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто2</dataPath>
				<field>Субконто2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Субконто3</dataPath>
				<field>Субконто3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт1</dataPath>
				<field>СубконтоКт1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт2</dataPath>
				<field>СубконтоКт2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт3</dataPath>
				<field>СубконтоКт3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт1</dataPath>
				<field>СубконтоДт1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт2</dataPath>
				<field>СубконтоДт2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт3</dataPath>
				<field>СубконтоДт3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>БИТ_МСФО_ПланСчетов</dataPath>
				<field>БИТ_МСФО_ПланСчетов</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Валюта</dataPath>
				<field>Валюта</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКт</dataPath>
				<field>ВалютаКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаДт</dataPath>
				<field>ВалютаДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДатаДока</dataPath>
				<field>ДатаДока</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Дата дока</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Количество</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначение</dataPath>
				<field>НалоговоеНазначение</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначениеКт</dataPath>
				<field>НалоговоеНазначениеКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначениеДт</dataPath>
				<field>НалоговоеНазначениеДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Партия</dataPath>
				<field>Партия</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Партия</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Подразделение</dataPath>
				<field>Подразделение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПодразделениеКт</dataPath>
				<field>ПодразделениеКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПодразделениеДт</dataPath>
				<field>ПодразделениеДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Склад</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаГрн</dataPath>
				<field>СуммаГрн</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма, грн.</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДол</dataPath>
				<field>СуммаДол</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма, дол.</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТМЦ</dataPath>
				<field>ТМЦ</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>ТМЦ</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЭтоПоПеремещению</dataPath>
				<field>ЭтоПоПеремещению</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Это по перемещению</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Рег.Субконто1 КАК ТМЦ,
	Рег.Субконто2 КАК Склад,
	Рег.Субконто3 КАК Партия,
	Рег.НалоговоеНазначение,
	Рег.СуммаОстаток КАК СуммаДол,
	Рег.ВалютнаяСуммаОстаток КАК СуммаГрн,
	Рег.КоличествоОстаток КАК Количество
ПОМЕСТИТЬ Остатки
ИЗ
	РегистрБухгалтерии.МСФО.Остатки(&amp;Дата, Счет = &amp;Счет, , ) КАК Рег
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Рег.СубконтоДт1 КАК ТМЦ,
	Рег.СубконтоДт2 КАК Склад,
	Рег.СубконтоДт3 КАК Партия,
	Рег.НалоговоеНазначениеДт КАК НалоговоеНазначение,
	Рег.СубконтоКт3 КАК ПартияНачальная,
	Рег.СуммаОборот КАК СуммаДол,
	Рег.ВалютнаяСуммаОборотДт КАК СуммаГрн,
	Рег.КоличествоОборотДт КАК Количество,
	РегВсего.СуммаОборот КАК СуммаДолВсего,
	РегВсего.ВалютнаяСуммаОборотДт КАК СуммаГрнВсего,
	РегВсего.КоличествоОборотДт КАК КоличествоВсего
ПОМЕСТИТЬ Перемещения
ИЗ
	РегистрБухгалтерии.МСФО.ОборотыДтКт(, &amp;Дата, Регистратор, СчетДт = &amp;Счет, , СчетКт = &amp;Счет, , ТИПЗНАЧЕНИЯ(СубконтоДт3) = ТИП(Документ.ПеремещениеТоваров)) КАК Рег
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрБухгалтерии.МСФО.ОборотыДтКт(, &amp;Дата, Регистратор, СчетДт = &amp;Счет, , СчетКт = &amp;Счет, , ТИПЗНАЧЕНИЯ(СубконтоДт3) = ТИП(Документ.ПеремещениеТоваров)) КАК РегВсего
		ПО Рег.СубконтоДт1 = РегВсего.СубконтоДт1
			И Рег.СубконтоДт2 = РегВсего.СубконтоДт2
			И Рег.СубконтоДт3 = РегВсего.СубконтоДт3
			И Рег.НалоговоеНазначениеДт = РегВсего.НалоговоеНазначениеДт
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Остатки.ТМЦ,
	Остатки.Склад,
	ВЫБОР
		КОГДА ТИПЗНАЧЕНИЯ(Остатки.Партия) = ТИП(Документ.ПеремещениеТоваров)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ЭтоПоПеремещению,
	ВЫБОР
		КОГДА ТИПЗНАЧЕНИЯ(Остатки.Партия) = ТИП(Документ.ПеремещениеТоваров)
				И НЕ Перемещения.ПартияНачальная ЕСТЬ NULL 
			ТОГДА Перемещения.ПартияНачальная
		ИНАЧЕ Остатки.Партия
	КОНЕЦ КАК Партия,
	Остатки.НалоговоеНазначение,
	ВЫБОР
		КОГДА Перемещения.Количество ЕСТЬ NULL 
				ИЛИ Перемещения.КоличествоВсего ЕСТЬ NULL 
			ТОГДА Остатки.Количество
		КОГДА Перемещения.Количество &lt; Перемещения.КоличествоВсего
			ТОГДА Остатки.Количество * Перемещения.Количество / Перемещения.КоличествоВсего
		ИНАЧЕ Остатки.Количество
	КОНЕЦ КАК Количество,
	ВЫБОР
		КОГДА Перемещения.СуммаДол ЕСТЬ NULL 
				ИЛИ Перемещения.СуммаДолВсего ЕСТЬ NULL 
			ТОГДА Остатки.СуммаДол
		КОГДА Перемещения.СуммаДол &lt; Перемещения.СуммаДолВсего
			ТОГДА Остатки.СуммаДол * Перемещения.СуммаДол / Перемещения.СуммаДолВсего
		ИНАЧЕ Остатки.СуммаДол
	КОНЕЦ КАК СуммаДол,
	ВЫБОР
		КОГДА Перемещения.СуммаГрн ЕСТЬ NULL 
				ИЛИ Перемещения.СуммаГрнВсего ЕСТЬ NULL 
			ТОГДА Остатки.СуммаГрн
		КОГДА Перемещения.СуммаГрн &lt; Перемещения.СуммаГрнВсего
			ТОГДА Остатки.СуммаГрн * Перемещения.СуммаГрн / Перемещения.СуммаГрнВсего
		ИНАЧЕ Остатки.СуммаГрн
	КОНЕЦ КАК СуммаГрн
ПОМЕСТИТЬ Врем
ИЗ
	Остатки КАК Остатки
		ЛЕВОЕ СОЕДИНЕНИЕ Перемещения КАК Перемещения
		ПО Остатки.ТМЦ = Перемещения.ТМЦ
			И Остатки.Склад = Перемещения.Склад
			И Остатки.Партия = Перемещения.Партия
			И Остатки.НалоговоеНазначение = Перемещения.НалоговоеНазначение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Врем.ТМЦ,
	Врем.Склад,
	Врем.ЭтоПоПеремещению,
	Врем.Партия,
	НАЧАЛОПЕРИОДА(Врем.Партия.Дата, ДЕНЬ) КАК ДатаДока,
	Врем.НалоговоеНазначение,
	Врем.Количество,
	Врем.СуммаДол,
	Врем.СуммаГрн
ИЗ
	Врем КАК Врем
ГДЕ
	Врем.Партия.Дата &lt; &amp;НачалоГода</query>
		</dataSet>
		<totalField>
			<dataPath>Количество</dataPath>
			<expression>Сумма(Количество)</expression>
		</totalField>
		<totalField>
			<dataPath>СуммаГрн</dataPath>
			<expression>Сумма(СуммаГрн)</expression>
		</totalField>
		<totalField>
			<dataPath>СуммаДол</dataPath>
			<expression>Сумма(СуммаДол)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>Период</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Период</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>Дата</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>НачалоГода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало года</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>Счет</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Счет</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core" xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:ChartOfAccountsRef.МСФО</Type>
			</valueType>
			<value xsi:nil="true"/>
			<useRestriction>true</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>ТМЦ</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>НалоговоеНазначение</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Количество</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СуммаГрн</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СуммаДол</field>
		</item>
	</selection>
	<order>
		<item xsi:type="OrderItemField">
			<field>ТМЦ</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>НалоговоеНазначение</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>ДатаДока</field>
			<orderType>Asc</orderType>
		</item>
	</order>
	<outputParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>РасположениеПолейГруппировки</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionGroupFieldsPlacement">Separately</dcscor:value>
		</dcscor:item>
	</outputParameters>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>ТМЦ</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>НалоговоеНазначение</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</item>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>