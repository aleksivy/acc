<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СчетКт</dataPath>
				<field>СчетКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СчетДт</dataPath>
				<field>СчетДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт1</dataPath>
				<field>СубконтоКт1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт2</dataPath>
				<field>СубконтоКт2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоКт3</dataPath>
				<field>СубконтоКт3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт1</dataPath>
				<field>СубконтоДт1</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт2</dataPath>
				<field>СубконтоДт2</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СубконтоДт3</dataPath>
				<field>СубконтоДт3</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаКт</dataPath>
				<field>ВалютаКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ВалютаДт</dataPath>
				<field>ВалютаДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначение</dataPath>
				<field>НалоговоеНазначение</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Налоговое назначение</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначениеКт</dataPath>
				<field>НалоговоеНазначениеКт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НалоговоеНазначениеДт</dataPath>
				<field>НалоговоеНазначениеДт</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Организация</dataPath>
				<field>Организация</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Партия</dataPath>
				<field>Партия</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Партия</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<ignoreNullValues xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</ignoreNullValues>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПродажаНижеСебестоимости</dataPath>
				<field>ПродажаНижеСебестоимости</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Продажа ниже себестоимости</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>ГоризонтальноеПоложение</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d7p1:HorizontalAlign">Center</value>
					</item>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">БЛ=' '; БИ=+</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Регистратор</dataPath>
				<field>Регистратор</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Регистратор</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Ставка НДС</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>ГоризонтальноеПоложение</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d7p1:HorizontalAlign">Center</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена70</dataPath>
				<field>Цена70</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Цена продажи без НДС</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена90</dataPath>
				<field>Цена90</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Цена партии</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество90Партии</dataPath>
				<field>Количество90Партии</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Количество</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Разница</dataPath>
				<field>Разница</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Разница</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Себестоимость</dataPath>
				<field>Себестоимость</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Себестоимость</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаПродажиБезНДС</dataPath>
				<field>СуммаПродажиБезНДС</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма продажи без НДС</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Рег90.Регистратор,
	Рег90.СубконтоКт3 КАК Партия,
	МАКСИМУМ(Рег90.НалоговоеНазначениеКт) КАК НалоговоеНазначениеПартии,
	СУММА(Рег90.КоличествоОборотКт) КАК Количество90Партии,
	СУММА(Рег90.СуммаОборот) КАК СебестоимостьПартии
ПОМЕСТИТЬ Рег90
ИЗ
	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(&amp;НачалоПериода, &amp;КонецПериода, Регистратор, СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьРеализации)), , , , ) КАК Рег90
ГДЕ
	ТИПЗНАЧЕНИЯ(Рег90.Регистратор) = ТИП(Документ.РеализацияТоваровУслуг)

СГРУППИРОВАТЬ ПО
	Рег90.Регистратор,
	Рег90.СубконтоКт3
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДокТЧ.Ссылка КАК Партия,
	МАКСИМУМ(ДокТЧ.СтавкаНДС) КАК СтавкаНДС
ПОМЕСТИТЬ СтатусНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ДокТЧ
ГДЕ
	ДокТЧ.Ссылка В
			(ВЫБРАТЬ
				Рег90.Партия
			ИЗ
				Рег90 КАК Рег90
			СГРУППИРОВАТЬ ПО
				Рег90.Партия)

СГРУППИРОВАТЬ ПО
	ДокТЧ.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Рег90.Регистратор,
	Рег90.Партия,
	Рег90.НалоговоеНазначениеПартии КАК НалоговоеНазначение,
	СтатусНДС.СтавкаНДС,
	ВЫБОР
		КОГДА Рег90.Количество90Партии = 0
			ТОГДА 1
		ИНАЧЕ Рег90.Количество90Партии
	КОНЕЦ КАК Количество90Партии,
	ВЫБОР
		КОГДА Рег90.Количество90Партии = 0
			ТОГДА Рег90.СебестоимостьПартии
		ИНАЧЕ ВЫРАЗИТЬ(Рег90.СебестоимостьПартии / Рег90.Количество90Партии КАК ЧИСЛО(12, 2))
	КОНЕЦ КАК Цена90
ПОМЕСТИТЬ Цены90
ИЗ
	Рег90 КАК Рег90
		ЛЕВОЕ СОЕДИНЕНИЕ СтатусНДС КАК СтатусНДС
		ПО Рег90.Партия = СтатусНДС.Партия
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РегНДС.Регистратор,
	СУММА(РегНДС.СуммаОборот) КАК СуммаНДС
ПОМЕСТИТЬ РегНДС
ИЗ
	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(&amp;НачалоПериода, &amp;КонецПериода, Регистратор, СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходыОтРеализации)), , СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НалоговыеОбязательстваВсего)), , ) КАК РегНДС
ГДЕ
	ТИПЗНАЧЕНИЯ(РегНДС.Регистратор) = ТИП(Документ.РеализацияТоваровУслуг)

СГРУППИРОВАТЬ ПО
	РегНДС.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Рег70.Регистратор,
	СУММА(Рег70.КоличествоОборотКт) КАК Количество70,
	СУММА(Рег70.СуммаОборот) КАК СуммаПродажи
ПОМЕСТИТЬ Рег70СНДС
ИЗ
	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(&amp;НачалоПериода, &amp;КонецПериода, Регистратор, , , СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходыОтРеализации)), , ) КАК Рег70
ГДЕ
	ТИПЗНАЧЕНИЯ(Рег70.Регистратор) = ТИП(Документ.РеализацияТоваровУслуг)

СГРУППИРОВАТЬ ПО
	Рег70.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Рег70СНДС.Регистратор КАК Регистратор,
	Рег70СНДС.Количество70 КАК Количество70,
	Рег70СНДС.СуммаПродажи - ЕСТЬNULL(РегНДС.СуммаНДС, 0) КАК СуммаПродажи,
	ВЫБОР
		КОГДА Рег70СНДС.Количество70 = 0
			ТОГДА Рег70СНДС.СуммаПродажи - ЕСТЬNULL(РегНДС.СуммаНДС, 0)
		ИНАЧЕ ВЫРАЗИТЬ((Рег70СНДС.СуммаПродажи - ЕСТЬNULL(РегНДС.СуммаНДС, 0)) / Рег70СНДС.Количество70 КАК ЧИСЛО(12, 2))
	КОНЕЦ КАК Цена70
ПОМЕСТИТЬ Рег70
ИЗ
	Рег70СНДС КАК Рег70СНДС
		ЛЕВОЕ СОЕДИНЕНИЕ РегНДС КАК РегНДС
		ПО Рег70СНДС.Регистратор = РегНДС.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(Рег70.Регистратор, Рег90.Регистратор) КАК Регистратор,
	ЕСТЬNULL(Рег90.Партия, ЗНАЧЕНИЕ(Документ.ПоступлениеТоваровУслуг.ПустаяСсылка)) КАК Партия,
	ЕСТЬNULL(Рег70.Цена70, 0) КАК Цена70,
	ЕСТЬNULL(Рег90.Цена90, 0) КАК Цена90,
	ВЫБОР
		КОГДА Рег90.СтавкаНДС ЕСТЬ NULL 
				И ТИПЗНАЧЕНИЯ(Рег90.Партия) = ТИП(Документ.ОтчетПроизводстваЗаСмену)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
		ИНАЧЕ Рег90.СтавкаНДС
	КОНЕЦ КАК СтавкаНДС,
	Рег90.НалоговоеНазначение,
	ВЫБОР
		КОГДА ЕСТЬNULL(Рег70.Цена70, 0) &lt; ЕСТЬNULL(Рег90.Цена90, 0)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ПродажаНижеСебестоимости,
	Рег90.Количество90Партии,
	ЕСТЬNULL(Рег70.Цена70, 0) * Рег90.Количество90Партии КАК СуммаПродажиБезНДС,
	ЕСТЬNULL(Рег90.Цена90, 0) * Рег90.Количество90Партии КАК Себестоимость,
	ЕСТЬNULL(Рег70.Цена70, 0) * Рег90.Количество90Партии - ЕСТЬNULL(Рег90.Цена90, 0) * Рег90.Количество90Партии КАК Разница
ИЗ
	Рег70 КАК Рег70
		ПОЛНОЕ СОЕДИНЕНИЕ Цены90 КАК Рег90
		ПО Рег70.Регистратор = Рег90.Регистратор</query>
		</dataSet>
		<totalField>
			<dataPath>Количество90Партии</dataPath>
			<expression>Сумма(Количество90Партии)</expression>
		</totalField>
		<totalField>
			<dataPath>Разница</dataPath>
			<expression>Сумма(Разница)</expression>
		</totalField>
		<totalField>
			<dataPath>СуммаПродажиБезНДС</dataPath>
			<expression>Сумма(СуммаПродажиБезНДС)</expression>
		</totalField>
		<totalField>
			<dataPath>Себестоимость</dataPath>
			<expression>Сумма(Себестоимость)</expression>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>false</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>Партия</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Регистратор</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>НалоговоеНазначение</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СтавкаНДС</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ПродажаНижеСебестоимости</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Цена70</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Цена90</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Количество90Партии</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СуммаПродажиБезНДС</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Себестоимость</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>Разница</field>
		</item>
	</selection>
	<order>
		<item xsi:type="OrderItemField">
			<field>Партия</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>Регистратор</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>НалоговоеНазначение</field>
			<orderType>Asc</orderType>
		</item>
		<item xsi:type="OrderItemField">
			<field>СтавкаНДС</field>
			<orderType>Asc</orderType>
		</item>
	</order>
	<item xsi:type="StructureItemGroup">
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>